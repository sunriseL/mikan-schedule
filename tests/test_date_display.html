<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥æœŸæ˜¾ç¤ºä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .test-results {
            background: #f3e5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .test-results h3 {
            color: #7b1fa2;
            margin-top: 0;
        }
        .event-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .event-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        .event-date {
            color: #1976d2;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .event-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .event-venue {
            color: #666;
            font-size: 0.9em;
        }
        button {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        .fix-summary {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>æ—¥æœŸæ˜¾ç¤ºä¿®å¤æµ‹è¯•</h1>
        
        <div class="fix-summary">
            <h2>ä¿®å¤å†…å®¹</h2>
            <p><strong>é—®é¢˜ï¼š</strong>åœ¨åˆ—è¡¨è§†å›¾ä¸­ï¼Œ2024å¹´çš„æ´»åŠ¨è¢«é”™è¯¯åœ°æ˜¾ç¤ºä¸º2025å¹´</p>
            <p><strong>åŸå› ï¼š</strong>åœ¨ <code>EventCardComponent.formatDate()</code> æ–¹æ³•ä¸­ç¡¬ç¼–ç äº†2025å¹´</p>
            <p><strong>ä¿®å¤ï¼š</strong>æ”¹ä¸ºä½¿ç”¨æ´»åŠ¨æ•°æ®ä¸­çš„å®é™…å¹´ä»½</p>
        </div>

        <div class="test-info">
            <h2>æµ‹è¯•ç›®çš„</h2>
            <p>éªŒè¯ä¿®å¤åçš„æ—¥æœŸæ˜¾ç¤ºåŠŸèƒ½ï¼Œç¡®ä¿æ´»åŠ¨æ˜¾ç¤ºæ­£ç¡®çš„å¹´ä»½ï¼š</p>
            <ul>
                <li>âœ… 2024å¹´çš„æ´»åŠ¨åº”è¯¥æ˜¾ç¤º2024å¹´</li>
                <li>âœ… 2025å¹´çš„æ´»åŠ¨åº”è¯¥æ˜¾ç¤º2025å¹´</li>
                <li>âœ… æ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®ï¼ˆYYYY-MM-DDï¼‰</li>
                <li>âœ… æ˜ŸæœŸå‡ æ˜¾ç¤ºåº”è¯¥æ­£ç¡®</li>
            </ul>
        </div>

        <div class="test-results">
            <h3>æ´»åŠ¨ç¤ºä¾‹</h3>
            <div class="event-examples" id="event-examples">
                <div class="event-card">
                    <div class="event-date">åŠ è½½ä¸­...</div>
                    <div class="event-title">åŠ è½½ä¸­...</div>
                    <div class="event-venue">åŠ è½½ä¸­...</div>
                </div>
            </div>
            
            <button onclick="loadEventExamples()">åŠ è½½æ´»åŠ¨ç¤ºä¾‹</button>
            <button onclick="testDateFormatting()">æµ‹è¯•æ—¥æœŸæ ¼å¼åŒ–</button>
            <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
            
            <div class="console-output" id="console-output">
                <div>æ§åˆ¶å°è¾“å‡ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="components.js"></script>
    <script src="i18n.js"></script>
    <script>
        let dataManager = null;
        let loadedData = null;

        function log(message) {
            const console = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            console.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console-output').innerHTML = '<div>æ§åˆ¶å°å·²æ¸…ç©º...</div>';
        }

        async function loadEventExamples() {
            log('å¼€å§‹åŠ è½½æ´»åŠ¨ç¤ºä¾‹...');
            
            try {
                const response = await fetch('activities.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                loadedData = await response.json();
                log(`æ•°æ®åŠ è½½æˆåŠŸï¼Œæ€»æ´»åŠ¨æ•°: ${loadedData.events.length}`);
                
                // åˆ›å»ºæ•°æ®ç®¡ç†å™¨
                dataManager = new ScheduleDataManager();
                dataManager.loadFromJSON(loadedData);
                
                // è·å–2024å¹´å’Œ2025å¹´çš„æ´»åŠ¨ç¤ºä¾‹
                const events2024 = dataManager.getEvents({ year: 2024 }).slice(0, 3);
                const events2025 = dataManager.getEvents({ year: 2025 }).slice(0, 3);
                
                log(`æ‰¾åˆ°2024å¹´æ´»åŠ¨: ${events2024.length}ä¸ª`);
                log(`æ‰¾åˆ°2025å¹´æ´»åŠ¨: ${events2025.length}ä¸ª`);
                
                // æ˜¾ç¤ºæ´»åŠ¨ç¤ºä¾‹
                displayEventExamples([...events2024, ...events2025]);
                
            } catch (error) {
                log(`æ•°æ®åŠ è½½å¤±è´¥: ${error.message}`);
            }
        }

        function displayEventExamples(events) {
            const container = document.getElementById('event-examples');
            container.innerHTML = '';
            
            events.forEach(event => {
                // åˆ›å»ºEventCardComponentæ¥æµ‹è¯•æ—¥æœŸæ ¼å¼åŒ–
                const eventCard = new EventCardComponent(event, { id: 'test', name: 'æµ‹è¯•åˆ†ç±»', icon: 'ğŸ­' });
                const eventElement = eventCard.render();
                
                // æå–æ—¥æœŸä¿¡æ¯
                const dateElement = eventElement.querySelector('.event-date');
                const titleElement = eventElement.querySelector('.event-title');
                const venueElement = eventElement.querySelector('.event-venue');
                
                const eventCardDiv = document.createElement('div');
                eventCardDiv.className = 'event-card';
                eventCardDiv.innerHTML = `
                    <div class="event-date">${dateElement ? dateElement.textContent : 'æ—¥æœŸæœªçŸ¥'}</div>
                    <div class="event-title">${titleElement ? titleElement.textContent : 'æ ‡é¢˜æœªçŸ¥'}</div>
                    <div class="event-venue">${venueElement ? venueElement.textContent : 'åœºåœ°æœªçŸ¥'}</div>
                    <div style="font-size: 0.8em; color: #999; margin-top: 5px;">
                        å®é™…å¹´ä»½: ${event.year}, æ—¥æœŸèŒƒå›´: ${event.dateRange}
                    </div>
                `;
                
                container.appendChild(eventCardDiv);
                
                log(`æ´»åŠ¨: ${event.title} - æ˜¾ç¤ºæ—¥æœŸ: ${dateElement ? dateElement.textContent : 'æœªçŸ¥'} - å®é™…å¹´ä»½: ${event.year}`);
            });
        }

        function testDateFormatting() {
            if (!dataManager) {
                log('è¯·å…ˆåŠ è½½æ•°æ®');
                return;
            }
            
            log('å¼€å§‹æµ‹è¯•æ—¥æœŸæ ¼å¼åŒ–...');
            
            // æµ‹è¯•ä¸€äº›ç‰¹å®šçš„æ—¥æœŸ
            const testEvents = [
                { dateRange: '1.31', year: 2024, title: '2024å¹´1æœˆ31æ—¥æ´»åŠ¨' },
                { dateRange: '2.1', year: 2024, title: '2024å¹´2æœˆ1æ—¥æ´»åŠ¨' },
                { dateRange: '7.30', year: 2025, title: '2025å¹´7æœˆ30æ—¥æ´»åŠ¨' },
                { dateRange: '8.2', year: 2025, title: '2025å¹´8æœˆ2æ—¥æ´»åŠ¨' }
            ];
            
            testEvents.forEach(testEvent => {
                const eventCard = new EventCardComponent(testEvent, { id: 'test', name: 'æµ‹è¯•åˆ†ç±»', icon: 'ğŸ­' });
                const formattedDate = eventCard.formatDate(testEvent.dateRange);
                log(`æµ‹è¯•: ${testEvent.title} - è¾“å…¥: ${testEvent.dateRange} (${testEvent.year}å¹´) - è¾“å‡º: ${formattedDate}`);
            });
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½æ•°æ®
        window.addEventListener('load', () => {
            log('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•æ—¥æœŸæ˜¾ç¤ºä¿®å¤...');
        });
    </script>
</body>
</html> 