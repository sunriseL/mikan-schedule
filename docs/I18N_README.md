# 多语言功能说明

## 概述

本项目已成功添加了多语言支持功能，支持中文和日语两种语言。用户可以通过页面右上角的语言切换器来切换语言，所有界面文本（除了活动数据本身）都会相应更新。

## 功能特性

### 1. 语言切换器
- 位置：页面右上角
- 支持语言：中文、日本語
- 样式：美观的按钮设计，带有悬停效果
- 响应式：在移动设备上自动调整大小

### 2. 支持多语言的界面元素

#### 页面标题和头部
- 网站标题
- 加载提示文本
- 错误信息

#### 过滤器区域
- 筛选活动标题
- 视图切换按钮（日历视图/列表视图）
- 分类和月份选择器
- 活动计数显示

#### 活动详情
- 会场信息
- 时间信息（开演、终演）
- 未定状态显示

#### 统计信息
- 活动统计标题
- 总活动数
- 即将到来的活动

#### 日历视图
- 星期名称（日、月、火、水、木、金、土）
- 月份名称（1月、2月、3月...）
- 活动卡片中的场地信息

#### 底部装饰
- PR备注信息

### 3. 语言持久化
- 用户的语言选择会保存在浏览器的localStorage中
- 下次访问时会自动使用上次选择的语言

## 技术实现

### 文件结构
```
├── i18n.js              # 多语言配置和语言管理器
├── components.js        # 更新了所有组件以支持多语言
├── app.js              # 更新了主应用以支持语言切换
├── styles.css          # 添加了语言切换器的样式
└── index.html          # 更新了HTML结构
```

### 核心类

#### LanguageManager
- `setLanguage(lang)`: 设置语言
- `getCurrentLanguage()`: 获取当前语言
- `t(key)`: 获取翻译文本
- `addListener(callback)`: 添加语言变化监听器

#### I18N配置
- 支持嵌套键值（如 `weekdays.Mon.`）
- 自动回退到中文（如果当前语言没有找到对应翻译）
- 支持动态文本替换

### 使用方法

#### 在组件中使用翻译
```javascript
// 简单文本
const title = languageManager.t('siteTitle');

// 嵌套键值
const monday = languageManager.t('weekdays.Mon.');

// 月份
const june = languageManager.t('months.6');
```

#### 监听语言变化
```javascript
languageManager.addListener((newLanguage) => {
    // 重新渲染组件
    this.render();
});
```

## 测试

### 测试页面
访问 `test_i18n.html` 可以测试所有翻译功能是否正常工作。

### 测试步骤
1. 打开测试页面
2. 点击语言切换按钮
3. 观察所有文本是否正确更新
4. 刷新页面，确认语言设置是否保持

## 添加新语言

### 1. 在i18n.js中添加新语言配置
```javascript
const I18N = {
    zh: { /* 中文配置 */ },
    ja: { /* 日语配置 */ },
    en: { /* 英文配置 */
        siteTitle: "Kohinata Mika 2025 Event Schedule",
        // ... 其他翻译
    }
};
```

### 2. 更新语言切换器
在 `LanguageSwitcherComponent` 中添加新的语言按钮。

### 3. 更新CSS样式
确保新语言按钮在移动设备上也能正常显示。

## 注意事项

1. **活动数据不翻译**：根据需求，活动标题、描述等数据本身不进行翻译，只翻译界面文本。

2. **字体支持**：确保选择的字体支持所有目标语言。

3. **文本长度**：不同语言的文本长度可能不同，需要确保UI布局能够适应。

4. **RTL支持**：如果需要支持阿拉伯语等RTL语言，需要额外的CSS配置。

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 性能优化

- 语言配置在页面加载时一次性加载
- 使用事件监听器避免不必要的重新渲染
- 语言设置使用localStorage进行持久化存储

## 故障排除

### 常见问题

1. **翻译不显示**
   - 检查键名是否正确
   - 确认语言配置中是否包含该键

2. **语言切换不生效**
   - 检查语言管理器是否正确初始化
   - 确认组件是否正确监听语言变化

3. **样式问题**
   - 检查CSS是否正确加载
   - 确认响应式样式是否正常工作

### 调试方法

1. 打开浏览器控制台
2. 检查 `languageManager` 对象是否正确创建
3. 使用 `languageManager.t('key')` 测试翻译功能
4. 检查localStorage中的语言设置 